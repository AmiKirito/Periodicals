@using Client.ViewModels
@model PublisherCreateViewModel

@{
    ViewBag.Title = "New";
}

<h2>Create Publisher</h2>

<script>
    var firstAuthor = true;
    var firstTopic = true;

    $(document).ready(function (e) {
        $("#ExistingAuthors").change(function () {
            var alltext = $('input[name=Authors]').val();
            var textval = $(":selected", this).val();

            if (textval != '') {
                if (firstAuthor) {
                    firstAuthor = false;
                    alltext += textval;
                }
                else {
                    alltext += ';' + textval;
                }
            }

            $('input[name=Authors]').val(alltext);
            $("#ExistingAuthors option:selected").remove();
        });
        $("#ExistingTopics").change(function () {
            var alltext = $('input[name=Topics]').val();
            var textval = $(":selected", this).val();

            if (textval != '') {
                if (firstTopic) {
                    firstTopic = false;
                    alltext += textval;
                }
                else {
                    alltext += ';' + textval;
                }
            }

            $('input[name=Topics]').val(alltext);
            $("#ExistingTopics option:selected").remove();
        })
    });
</script>

@using (Html.BeginForm("New", "Publisher", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    <div class="form-group">
        @Html.LabelFor(model => model.Title)
        @Html.EditorFor(model => model.Title)
        @Html.ValidationMessageFor(model => model.Title, "", new { @class = "text-danger" })
    </div>
    <div class="form-group">
        @Html.LabelFor(model => model.Description)
        @Html.EditorFor(model => model.Description)
        @Html.ValidationMessageFor(model => model.Description, "", new { @class = "text-danger" })
    </div>
    <div class="form-group">
        @Html.LabelFor(model => model.MonthlySubscriptionPrice)
        @Html.EditorFor(model => model.MonthlySubscriptionPrice)
        @Html.ValidationMessageFor(model => model.MonthlySubscriptionPrice, "", new { @class = "text-danger" })
    </div>
    <div class="form-group">
        @Html.EditorFor(model => model.Authors)
        @Html.ValidationMessageFor(model => model.Authors, "", new { @class = "text-danger" })
        @Html.DropDownList("ExistingAuthors", Model.ExistingAuthors, new { @class = "custom-select", @id = "ExistingAuthors" })
    </div>
    <div class="form-group">
        @Html.EditorFor(model => model.Topics)
        @Html.ValidationMessageFor(model => model.Topics, "", new { @class = "text-danger" })
        @Html.DropDownList("ExistingTopics", Model.ExistingTopics, new { @class = "custom-select", @id = "ExistingTopics" })
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.Image, new { @class = "text-dark" })
        @Html.TextBoxFor(model => model.Image, new { type = "file", @class = "form-control-file" })
        @Html.ValidationMessageFor(model => model.Image, "", new { @class = "text-danger" })
    </div>


    <input type="submit" value="Create" />

    @Html.ValidationSummary(true);
}

